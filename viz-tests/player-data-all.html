<!-- Code from https://d3-graph-gallery.com/graph/lollipop_button_data_csv.html -->
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Player Stats</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
      body{
        background: linear-gradient(90deg in hsl shorter hue, #fff5e6, #ffdbff, #d6ffd9);
      }

      iframe{
            margin: 10%;
            margin-top: 35px;
            max-width: 80%;
                
        }
      
      #container{
        padding: 1cm;
      }
      h2{
          margin-left: 400px;
      }

      .line-chart, .lollipop{
        margin-top:200px;
      }

      .line-chart{
        margin: 50px;
      }

      .button-move{
        margin-left: 110px;
      }
      button{
        color: #F6BA20;
        background: #39257F;
        font-weight: bold;
        margin: 5px;
        margin-left: 50px;
        border-radius: 30px;
        padding: 6px;
      }
      button:hover{
        color: #39257F;
        background: #F6BA20;
        
      }

      button:active{
        color: indigo;
        background: rosybrown;
      }

     
      .tooltip{
            position: absolute;
            width: max-content;
            height: 20px;
            padding: 4px;    
            text-align: center; 
            font-family:sans-serif;
            font-size: 14px;
            font-weight: bold;
            background: rgb(189, 217, 249);
            color: black; 
            border-radius: 16px;
          }

      
    </style>
  </head>
  <body>
    <div class="timeline">
      <iframe src='https://cdn.knightlab.com/libs/timeline3/latest/embed/index.html?source=v2:2PACX-1vQEc1FHfeCuhFMgphMMIbd3D7mbRxNPj_jgqEh45j9qXWhvZeqs_yzYRsrMAG_BHmdlAXcI6eo4Rkqn&font=Default&lang=en&initial_zoom=2&height=650' width='100%' height='650' webkitallowfullscreen mozallowfullscreen allowfullscreen frameborder='0'></iframe>
    </div>
    
    <br/>
    <br/>

    <div class="storyline">
      <iframe src="https://cdn.knightlab.com/libs/storyline/latest/embed/index.html?dataURL=https%3A%2F%2Fdocs.google.com%2Fspreadsheets%2Fd%2Fe%2F2PACX-1vTudAI-q39pavzERCsM_k_jPUBY3XBVQp24y_f7G5VkDAwLY6zhyLBD7h9HvpWKzsr_FqeGk4-uJ_BU%2Fpubhtml&amp;dataYCol=black&amp;dataXCol=year&amp;dataDateFormat=%25Y&amp;chartDateFormat=%25Y&amp;chartYLabel=black&amp;sliderCardTitleCol=title&amp;sliderCardTextCol=text" style="width:100%;height:650px;" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0"></iframe>
    </div>
    
    <div class="line-chart">
      <iframe title="Player demographics from 1947-2023" aria-label="Interactive line chart" id="datawrapper-chart-IzFlO" src="https://datawrapper.dwcdn.net/IzFlO/6/" scrolling="no" frameborder="0" style="width: 0; min-width: 80% !important; border: none;" height="667" data-external="1"></iframe><script type="text/javascript">!function(){"use strict";window.addEventListener("message",(function(a){if(void 0!==a.data["datawrapper-height"]){var e=document.querySelectorAll("iframe");for(var t in a.data["datawrapper-height"])for(var r,i=0;r=e[i];i++)if(r.contentWindow===a.source){var d=a.data["datawrapper-height"][t]+"px";r.style.height=d}}}))}();
    </script>
    </div>

    <br/>
    <br/>

    <div class="beeswarm">
      <iframe title="Fan attendance during Negro Leagues" aria-label="Beeswarm" id="rawgraphs-chart-oBQ4R" src="../images/graphs/fan-attendance-beeswarm.svg" scrolling="no" frameborder="0" style="width: 0; min-width: 70% !important; border: none;" height="700" data-external="1"></iframe><script type="text/javascript">!function(){"use strict";window.addEventListener("message",(function(a){if(void 0!==a.data["rawgraphs-height"]){var e=document.querySelectorAll("iframe");for(var t in a.data["rawgraphs-height"])for(var r,i=0;r=e[i];i++)if(r.contentWindow===a.source){var d=a.data["rawgraphs-height"][t]+"px";r.style.height=d}}}))}();
    </script>
    </div>

    <br/>
    <br/>

    <div class="scatter">
      <iframe title="How successful were the Negro Leagues? Let's examine fan attendance at the games." aria-label="Scatter Plot" id="datawrapper-chart-oBQ4R" src="https://datawrapper.dwcdn.net/oBQ4R/9/" scrolling="no" frameborder="0" style="width: 0; min-width: 80% !important; border: none;" height="732" data-external="1"></iframe><script type="text/javascript">!function(){"use strict";window.addEventListener("message",(function(a){if(void 0!==a.data["datawrapper-height"]){var e=document.querySelectorAll("iframe");for(var t in a.data["datawrapper-height"])for(var r,i=0;r=e[i];i++)if(r.contentWindow===a.source){var d=a.data["datawrapper-height"][t]+"px";r.style.height=d}}}))}();
    </script>
    </div>

    <br/>
    <br/>

    <div class="mlb-fans">
      <iframe title="MLB attendance 1903-1961" aria-label="Multiple Lines" id="datawrapper-chart-OsT4j" src="https://datawrapper.dwcdn.net/OsT4j/3/" scrolling="no" frameborder="0" style="width: 0; min-width: 75% !important; border: none;" height="785" data-external="1"></iframe><script type="text/javascript">!function(){"use strict";window.addEventListener("message",(function(a){if(void 0!==a.data["datawrapper-height"]){var e=document.querySelectorAll("iframe");for(var t in a.data["datawrapper-height"])for(var r,i=0;r=e[i];i++)if(r.contentWindow===a.source){var d=a.data["datawrapper-height"][t]+"px";r.style.height=d}}}))}();
    </script>
    </div>

    <br/>
    <br/>

    <div class="donut">
      <iframe title="Estimated NCAA Revenue Sharing (2025-2026)Â " aria-label="Multiple Donuts" id="datawrapper-chart-JwsFz" src="https://datawrapper.dwcdn.net/JwsFz/5/" scrolling="no" frameborder="0" style="width: 0; min-width: 80% !important; border: none;" height="766" data-external="1"></iframe><script type="text/javascript">!function(){"use strict";window.addEventListener("message",(function(a){if(void 0!==a.data["datawrapper-height"]){var e=document.querySelectorAll("iframe");for(var t in a.data["datawrapper-height"])for(var r,i=0;r=e[i];i++)if(r.contentWindow===a.source){var d=a.data["datawrapper-height"][t]+"px";r.style.height=d}}}))}();
    </script>
    </div>

    <br/>
    <br/>
    <div class="bar-chart">
      <iframe title="Scholarship Increases For Men's NCAA I Sports" aria-label="Split Bars" id="datawrapper-chart-A4gPW" src="https://datawrapper.dwcdn.net/A4gPW/8/" scrolling="no" frameborder="0" style="width: 0; min-width: 80% !important; border: none;" height="727" data-external="1"></iframe><script type="text/javascript">!function(){"use strict";window.addEventListener("message",(function(a){if(void 0!==a.data["datawrapper-height"]){var e=document.querySelectorAll("iframe");for(var t in a.data["datawrapper-height"])for(var r,i=0;r=e[i];i++)if(r.contentWindow===a.source){var d=a.data["datawrapper-height"][t]+"px";r.style.height=d}}}))}();
    </script>
    </div>
    <br/>
    <br/>

    <div class="lollipop">
      <h2 style="color: #208529">A comparison of Negro League playing stats</h2>
      <!-- Add buttons with event listener onclick="update" - must define update as a function in the script -->
      <p>When the MLB decided in 2024 to incorporate Negro League statistics into the official record book, there was much debate and skepticism. <span>The leagues, playing style, and season length were "different".</span> However, one must understand that those differences came from the constraints imposed during the time of segregation. Negro Leagues did what they could with the resources they had under the given circumstances.</p>
      <cite>NOTE: Stats differed based on the website. These stats came from MLB.com through the history of the negro leagues section. (ex:<a href="https://www.mlb.com/history/negro-leagues/players/josh-gibson" target="_blank"> Source</a>).</cite>
      <div class="button-move">
        <button onclick="update('ab')">At Bats</button>
        <button onclick="update('r')">Runs</button>
        <button onclick="update('h')">Hits</button>
        <button onclick="update('hr')">Home Runs</button>
        <button onclick="update('rbi')">Runs Batted In</button>
        <button onclick="update('sb')">Stolen Bases</button>
        <button onclick="update('avg')">Batting Average</button>
      </div>
      <div id="container"></div>

    </div>
    
    <script>

      // SET DIMENSIONS & MARGINS
      const margin = { top: 30, right: 30, bottom: 70, left: 120 },
        width = 800,
        height = 650;

      // CREATE SVG & APPEND TO BODY
      const svg = d3.select("#container")
        .append("svg")
        .attr("class", "svg")
        .attr("width", width + margin.right + margin.left)
        .attr("height", height + margin.top + margin.bottom)
        .append("g")
        .attr("transform",
          "translate(" + margin.left + "," + margin.top + ")");

        // CREATE TOOLTIP
        // TOOLTIP - REQUIRES 3 FUNCTIONS
        const tooltip = d3.select("#container")
            .append("div")
            .attr("class", "tooltip") //class for styling in CSS
            .style("opacity", 0); //opacity set to 0 is invisible until used
      

      // INITIALIZE X-AXIS
      const x = d3.scaleLinear()
        .range([0, width])
      const xAxis = svg.append("g")
        .attr("transform", "translate(0," + height + ")")
        .attr("class", "x-axis")
        

      // INITIALIZE Y-AXIS
      const y = d3.scaleBand()
        .range([height, 0])
        .padding(1);
      const yAxis = svg.append("g")
        .attr("class", "y-axis")



      // DEFINE FUNCTION UPDATE THAT CREATES/UPDATES THE CHART FOR GIVEN VARIABLE
      //THIS UPDATE IS CONNECTED TO THE BUTTONS ONCLICK"UPDATE" IN HTML
      function update(selectedStat) {

        // LOAD/PARSE DATA
        d3.csv("../data/player-stats.csv").then(data => {

          console.log('data', data);

          //FORMAT THE DATA
                data.forEach(d => {
                  d.name = d.name;
                  d.ab = d.ab;
                  d.r = d.r;
                  d.h = +d.h;
                  d.hr = +d.hr;
                  d.rbi = +d.rbi;
                  d.sb = +d.sb;
                  d.avg = +d.avg;
                });
          
          //SORT THE DATA - descending  
          data.sort((a, b) => b.name - a.name);//not working
          //data.sort(d3.ascending) //doesn't work

          // X-AXIS
          x.domain([0, d3.max(data, d => +d[selectedStat])])
          xAxis
            .transition()
            .duration(1000)
            .call(d3.axisBottom(x))
            .selectAll("text")
            .attr("fill", "black")
            .attr("font-weight", 500)


          // Y-AXIS
          y.domain(data.map(d => d.name));
          yAxis
          .transition()
          .duration(1000)
          .call(d3.axisLeft(y))
          .selectAll("text")
          .attr("fill", "black");


          //1ST TOOLTIP FUNCTION - MOUSEOVER
          const mouseover = function (event, d) {  //listen for events being triggered on done elements
            tooltip  //give things to the tooltip
              .html(d.name + " - " + +d[selectedStat])//can add HTML features, like line break
              .style("opacity", 1) //opacity set to 1 is visible - mouse hovers & you can see it
              //Add absolute position of mouse b/c tooltip follows mouse
              .style("left", (event.pageX + 8) + "px")//mouse x coordinate - higher the # further away tooltip moves
              .style("top", (event.pageY + 8) + "px");//mouse y coordinate - higher the # further away tooltip moves
          }

          //2nd TOOLTIP FUNCTION - MOUSEMOVE
          //Use event & d
          const mousemove = function (event, d) {
            tooltip
              .style("left", (event.pageX + 8) + "px") //higher the # further away tooltip moves
              .style("top", (event.pageY + 8) + "px"); //higher the # further away tooltip moves
          }

          //3rd TOOLTIP FUNCTION - MOUSEOUT
          //Use event & d
          const mouseout = function (event, d) {
            tooltip
              .style("opacity", 0); //invisible when cursor leaves
          }


          // VARIABLE J: MAP DATA TO EXISTING CIRCLE
          const j = svg.selectAll(".myLine")
            .data(data)
          // update lines
          j
            .enter()
            .append("line")
            .attr("class", "myLine")
            .merge(j)
            .transition()
            .duration(1000)
            .attr("x1", d => x(+d[selectedStat]))
            .attr("x2", d => x(0))
            .attr("y1", d => y(d.name))
            .attr("y2", d => y(d.name))
            .attr("stroke", "#718a9b");


          // VARIABLE U: MAP DATA TO EXISTING CIRCLE
          const u = svg.selectAll("circle")
            .data(data)
          // UPDATE CIRCLE
          u
            .enter()
            .append("circle")
            .merge(u)
            .on("mouseover", mouseover) //NEW: .on() - this is event
            .on("mousemove", mousemove) //tells it what to do 
            .on("mouseout", mouseout)
            .transition()
            .duration(1000)
            .attr("cx", d => x(+d[selectedStat]))
            .attr("cy", d => y(d.name))
            .attr("r", 6)
            .style("fill", "#B23124")
            .attr("stroke", "#222224");
        })
      }

      // INITIALIZE PLOT
      update('name')

    </script>
  </body>
</html>








