<!-- Code from https://d3-graph-gallery.com/graph/lollipop_button_data_csv.html -->
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Player Stats</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <link rel="stylesheet" href="../styles/style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-SgOJa3DmI69IUzQ2PVdRZhwQ+dy64/BUtbMJw1MZ8t5HZApcHrRKUc4W0kG879m7" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/js/bootstrap.bundle.min.js" integrity="sha384-k6d4wzSIapyDyv1kpU366/PK5hCdSbCRGRCMv+eplOQJWyd1fbcAu9OCUj5zNLiq" crossorigin="anonymous"></script>
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Old+Standard+TT:ital,wght@0,400;0,700;1,400&family=Satisfy&display=swap');
      
      body{
          background: linear-gradient(90deg in hsl shorter hue, #fff5e6, #ffdbff);
        }

        .change-link{
           /* background: #ffcbcb9e; */
           background-color: rgba(203, 33, 225, 0.417);
            border-radius: 5px;
        }
      
      #container{
        padding: 1cm;
      }
      h2{
          text-align: center;
          color: var(--primary);
          margin-top: 15%;
          font-family: "Satisfy", cursive;
          font-weight: 700px;
          font-size: 44px;
      }

      p{
        padding-left: 20%;
        padding-right: 20%;
        text-align: center;
      }

      ul, li{
        padding-left: 20%;
        padding-right: 20%;
        text-align: center;
        list-style: none;
      }

      .shrink-text{
        font-size: 14px;
      }
      
      span{
        font-style: italic;
      }

      .summary{
        margin-top: -100px;
      }
      
      .button-move{
        margin-left: 110px;
        margin-top: 30px;
      }

      button{
        color: #F6BA20;
        background: #39257F;
        font-weight: bold;
        margin: 20px;
        margin-left: 50px;
        border-radius: 30px;
        padding: 6px;
        width: 5%;
      }
      button:hover{
        color: #39257F;
        background: #F6BA20;
        
      }

      button:active{
        color: indigo;
        background: rosybrown;
      }

     
      .tooltip{
            position: absolute;
            width: max-content;
            height: 20px;
            padding: 0.5px;    
            text-align: center; 
            font-family:sans-serif;
            font-size: 14px;
            font-weight: bold;
            background: rgb(189, 217, 249);
            color: black; 
            border-radius: 7px;
          }


        /*RESPONSIVENESS FOR SCREENS <= 1250px*/
        @media (width <= 1250px) {
          .summary{
            margin-top: 10%;
          }

          h2{
            font-size: 28px;
          }

          p{
            font-size: 16px;
          }
          
          .shrink-text{
            font-size: 12px;
          }
        }

      
    </style>
  </head>
  <body>
    <div class="container">
      <nav class="navbar navbar-expand-lg sm-body-tertiary change-link">
          <div class="container-fluid">
            <!-- <a class="navbar-brand" href="index.html">Home</a> -->
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
              <ul class="navbar-nav me-auto mb-2 mb-lg-0 d-flex gap-3">
                <li class="nav-item">
                  <a class="nav-link active" aria-current="page" href="../index-about.html">Main</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link active" aria-current="page" href="../people/index-people.html">Key Figures</a>
                </li>
                <li class="nav-item dropdown">
                  <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                    Timeline
                  </a>
                  <ul class="dropdown-menu">
                    <li><a class="dropdown-item" href="../timeline/index-timeline1.html">1860s-1886 (Pre-color line)</a></li>
                    <li><hr class="dropdown-divider"></li>
                    <li><a class="dropdown-item" href="../timeline/index-timeline2.html">1887-1919 (Pre-Negro League)</a></li>
                    <li><hr class="dropdown-divider"></li>
                    <li><a class="dropdown-item" href="../timeline/index-timeline3.html">1920-1931 (NNL I)</a></li>
                    <li><hr class="dropdown-divider"></li>
                    <li><a class="dropdown-item" href="../timeline/index-timeline4.html">1933-1948 (NNL II)</a></li>
                    <li><hr class="dropdown-divider"></li>
                    <li><a class="dropdown-item" href="../timeline/index-timeline5.html">Integration (1947)</a></li>
                    <li><hr class="dropdown-divider"></li>
                    <li><a class="dropdown-item" href="../timeline/index-timeline6.html">End of Negro Leagues (1947-1960s)</a></li>
                  </ul>
                </li>
                <li class="nav-item dropdown">
                  <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                    Viz
                  </a>
                  <ul class="dropdown-menu">
                      <li><a class="dropdown-item" href="index-attendance.html">Fan Attendance</a></li>
                      <li><hr class="dropdown-divider"></li>
                      <li><a class="dropdown-item" href="index-map.html">Map</a></li>
                      <li><hr class="dropdown-divider"></li>
                      <li><a class="dropdown-item" href="index-players.html">Demographics</a></li>
                      <li><hr class="dropdown-divider"></li>
                      <li><a class="dropdown-item" href="index-ncaa.html">NCAA Changes</a></li>
                  </ul>
                </li>
                <li class="nav-item">
                  <a class="nav-link active" aria-current="page" href="../index-sources.html">Sources</a>
                </li>
            </div>
          </div>
        </nav>
    </div>
    <div class="summary">
      <h2>A Comparison of Negro League Playing Statistics</h2>
    <!-- Add buttons with event listener onclick="update" - must define update as a function in the script -->
      <p>When the MLB decided in 2024 to incorporate Negro League statistics into the official record book, there was much debate and skepticism. <span>The leagues, playing style, and season length were "different".</span> However, one must understand that those differences came from the constraints imposed during the time of segregation. Negro Leagues did what they could with the resources they had under the given circumstances.</p>
      <ul>
        <li> <a href="https://www.mlb.com/glossary/standard-stats/at-bat" target="_blank">AB - At Bats</a> </li>
        <li> <a href="https://www.mlb.com/glossary/standard-stats/run" target="_blank">R - Runs</a></li>
        <li> <a href="https://www.mlb.com/glossary/standard-stats/hit" target="_blank">H - Hits</a></li>
        <li> <a href="https://www.mlb.com/glossary/standard-stats/home-run" target="_blank">HR - Home Runs</a></li>
        <li> <a href="https://www.mlb.com/glossary/standard-stats/runs-batted-in" target="_blank">RBI - Runs Batted In</a></li>
        <li> <a href="https://www.mlb.com/glossary/standard-stats/stolen-base" target="_blank">SB - Stolen Bases</a></li>
        <li> <a href="https://www.mlb.com/glossary/standard-stats/batting-average" target="_blank">AVG - Batting Average</a></li>
      </ul>
      <p class="shrink-text">NOTE: Stats differed based on the website. These stats came from MLB.com through the history of the negro leagues section and were selected because it only utilized the statistics from their time during the negro leagues, excluding any data from MLB stints. (Ex: <a href="https://www.mlb.com/history/negro-leagues/players/josh-gibson" target="_blank">Source</a>).</p>
    </div>
    
    
    <div class="button-move">
      <button title="At Bats" onclick="update('ab')">AB</button>
      <button title="Runs" onclick="update('r')">R</button>
      <button title="Hits" onclick="update('h')">H</button>
      <button title="Home Runs" onclick="update('hr')">HR</button>
      <button title="Runs Batted In" onclick="update('rbi')">RBI</button>
      <button title="Stolen Bases" onclick="update('sb')">SB</button>
      <button title="Batting Average" onclick="update('avg')">AVG</button>
    </div>
    <div id="container"></div>
    
    <script>

      // SET DIMENSIONS & MARGINS
      const margin = { top: 30, right: 30, bottom: 70, left: 120 },
        width = 800,
        height = 650;

      // CREATE SVG & APPEND TO BODY
      const svg = d3.select("#container")
        .append("svg")
        .attr("class", "svg")
        .attr("width", width + margin.right + margin.left)
        .attr("height", height + margin.top + margin.bottom)
        .append("g")
        .attr("transform",
          "translate(" + margin.left + "," + margin.top + ")");

        // CREATE TOOLTIP
        // TOOLTIP - REQUIRES 3 FUNCTIONS
        const tooltip = d3.select("#container")
            .append("div")
            .attr("class", "tooltip") //class for styling in CSS
            .style("opacity", 0); //opacity set to 0 is invisible until used
      

      // INITIALIZE X-AXIS
      const x = d3.scaleLinear()
        .range([0, width])
      const xAxis = svg.append("g")
        .attr("transform", "translate(0," + height + ")")
        .attr("class", "x-axis")
        

      // INITIALIZE Y-AXIS
      const y = d3.scaleBand()
        .range([height, 0])
        .padding(1);
      const yAxis = svg.append("g")
        .attr("class", "y-axis")



      // DEFINE FUNCTION UPDATE THAT CREATES/UPDATES THE CHART FOR GIVEN VARIABLE
      //THIS UPDATE IS CONNECTED TO THE BUTTONS ONCLICK"UPDATE" IN HTML
      function update(selectedStat) {

        // LOAD/PARSE DATA
        d3.csv("../data/player-stats.csv").then(data => {

          console.log('data', data);

          //FORMAT THE DATA
                data.forEach(d => {
                  d.name = d.name;
                  d.ab = d.ab;
                  d.r = d.r;
                  d.h = +d.h;
                  d.hr = +d.hr;
                  d.rbi = +d.rbi;
                  d.sb = +d.sb;
                  d.avg = +d.avg;
                });
          
          //SORT THE DATA - descending  
          data.sort((a, b) => b.name - a.name);//not working
          //data.sort(d3.ascending) //doesn't work

          // X-AXIS
          x.domain([0, d3.max(data, d => +d[selectedStat])])
          xAxis
            .transition()
            .duration(1000)
            .call(d3.axisBottom(x))
            .selectAll("text")
            .attr("fill", "black")
            .attr("font-weight", 500)


          // Y-AXIS
          y.domain(data.map(d => d.name));
          yAxis
          .transition()
          .duration(1000)
          .call(d3.axisLeft(y))
          .selectAll("text")
          .attr("fill", "black");


          //1ST TOOLTIP FUNCTION - MOUSEOVER
          const mouseover = function (event, d) {  //listen for events being triggered on done elements
            tooltip  //give things to the tooltip
              .html(d.name + " - " + +d[selectedStat])//can add HTML features, like line break
              .style("opacity", 1) //opacity set to 1 is visible - mouse hovers & you can see it
              //Add absolute position of mouse b/c tooltip follows mouse
              .style("left", (event.pageX + 8) + "px")//mouse x coordinate - higher the # further away tooltip moves
              .style("top", (event.pageY + 8) + "px");//mouse y coordinate - higher the # further away tooltip moves
          }

          //2nd TOOLTIP FUNCTION - MOUSEMOVE
          //Use event & d
          const mousemove = function (event, d) {
            tooltip
              .style("left", (event.pageX + 8) + "px") //higher the # further away tooltip moves
              .style("top", (event.pageY + 8) + "px"); //higher the # further away tooltip moves
          }

          //3rd TOOLTIP FUNCTION - MOUSEOUT
          //Use event & d
          const mouseout = function (event, d) {
            tooltip
              .style("opacity", 0); //invisible when cursor leaves
          }


          // VARIABLE J: MAP DATA TO EXISTING CIRCLE
          const j = svg.selectAll(".myLine")
            .data(data)
          // update lines
          j
            .enter()
            .append("line")
            .attr("class", "myLine")
            .merge(j)
            .transition()
            .duration(1000)
            .attr("x1", d => x(+d[selectedStat]))
            .attr("x2", d => x(0))
            .attr("y1", d => y(d.name))
            .attr("y2", d => y(d.name))
            .attr("stroke", "#718a9b");


          // VARIABLE U: MAP DATA TO EXISTING CIRCLE
          const u = svg.selectAll("circle")
            .data(data)
          // UPDATE CIRCLE
          u
            .enter()
            .append("circle")
            .merge(u)
            .on("mouseover", mouseover) //NEW: .on() - this is event
            .on("mousemove", mousemove) //tells it what to do 
            .on("mouseout", mouseout)
            .transition()
            .duration(1000)
            .attr("cx", d => x(+d[selectedStat]))
            .attr("cy", d => y(d.name))
            .attr("r", 6)
            .style("fill", "#B23124")
            .attr("stroke", "#222224");
        })
      }

      // INITIALIZE PLOT
      update('name')

    </script>
  </body>
</html>








